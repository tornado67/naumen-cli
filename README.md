Автоматизатор Naumen.


Автоматизатор состоит из веб фронтенда (flask_engine) и непосредственно скрипта, с точкой входа main.py.
Обе части ставятся на одном сервере.
Файлы конфигурации:

config -  основной файл конфигурации. состоит из секций [db],[parser],[kkm]

 Секция [db] содержит параметрыи базы данных сервера Касперского:
 dbserver = <IP или имя хоста>  #адрес сервера БД
 user = <имя пользователя> имя пользователя для доменной авторизации
 pass = <пароль пользователя БД> пароль пользователя для доменной авторизации
 domain = <домен> имя домена

 Секция  [parser] содержит пути к файлам hosts и message
 hosts = < путь к файлу hosts>
 message = <путь к файлу message >

 Секция [kkm] содержить путь  к csv файлу

 csv = <путь к csv файлу с данными по ККТ>

 Файл hosts - файл содрежить информацию по хоастм на которых обнаружена проблема ИБ.
 Файл message содержит текст сообщения которое будет составлять тело заявки по ИБ.


Скрипт написан на python 3.5. Для его работы необходимо устаовить следующие модули:


pip3 install multipledispatch  # (используется для перегрузки функции)


pip3 install dateutil          # (используется для работы с датой.)


pip3 install pymssql           # (используется для получения событий из БД Касперского.)


pip3 install configparser      # (используется для разбора конфигурации)


После запуска точки входа (main.py) происходит парсинг аргументов, после чего из конфигурационного файла
(по умолчанию файл config в папке с main.py) скрипт получает параметры которые не были переданы опциями,
после чего производятся заданные действия.

Работа фронтенад протестирована с использованием Apache2. Тем не менее, подойдет любой веб сервер
способный отображать статические страницы.


При получении инормаии от пользователя формируется файл hosts и запускается скрипт с указаним созданнрго hosts файла.
Для работы веб фронтенда понадобится пакет python-flask.


Для развертывания веб фронтенда необходимо скопировать СОДЕРЖИМОЕ папки flask_engine в предварительно
созданую директорию веб сервера после чего выполнить следующие команды:


export FLASK_APP=/var/www/html/n/main.py # путь к файлу main.py из папки flask_engine в директории веб сервера


flask run --host=0.0.0.0 # запуск flask приложения на всех интерфейсах устрйоства.
